var xe=Object.defineProperty,Se=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable;var Z=(r,t,s)=>t in r?xe(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,C=(r,t)=>{for(var s in t||(t={}))Ce.call(t,s)&&Z(r,s,t[s]);if(Y)for(var s of Y(t))Ne.call(t,s)&&Z(r,s,t[s]);return r},F=(r,t)=>Se(r,Ie(t));import{i as Ae,g as ke,L as Le,a as Re,r as h,o as Pe,j as m,b as e,c as De,s as Me,d as Be,N as W,C as R,e as z,f as Ee,F as y,h as J,V as A,p as H,D as U,U as M,K as B,w as _,k as X,l as Fe,u as T,m as ee,v as O,T as q,n as E,y as Ue,I as Te,R as te,q as re,B as b,t as Oe,x as qe,z as $e,P as je,A as $,M as x,E as p,G as Ge,H as se,J as We,O as ze,Q as He,S as P,W as _e,X as Ke,Y as Qe,Z as Ve,_ as Ye,$ as Ze,a0 as Je}from"./vendor.c97dde0b.js";const Xe=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=s(n);fetch(n.href,a)}};Xe();const et={apiKey:"AIzaSyBvo498Ndy4hxto3yV4hIAsmlZx85gdRhs",authDomain:"photo-review-aad07.firebaseapp.com",projectId:"photo-review-aad07",storageBucket:"photo-review-aad07.appspot.com",messagingSenderId:"570970856677",appId:"1:570970856677:web:abd2e7c16a5f9db671080c"},ne=Ae(et),j=ke(),S=Le(ne),oe=Re(ne),ae=h.exports.createContext(),k=()=>h.exports.useContext(ae),tt=({children:r})=>{const[t,s]=h.exports.useState(null),[o,n]=h.exports.useState(!0);h.exports.useEffect(()=>{Pe(j,d=>{s(d),n(!1)})},[]);const i={user:t,register:(d,l)=>De(j,d,l),login:(d,l)=>Me(j,d,l),logout:()=>Be(j)};return m(ae.Provider,{value:i,children:[o&&e("h1",{children:"Loading ..."}),!o&&r]})},rt=()=>{const{user:r}=k();return e(W,{bg:"dark",variant:"dark",expand:"md",children:m(R,{children:[e(z,{to:"/",className:"navbar-brand",children:"Photo Reviewer"}),e(W.Toggle,{"aria-controls":"basic-navbar-nav"}),e(W.Collapse,{id:"basic-navbar-nav",children:e(Ee,{className:"ms-auto",children:r?e(y,{children:e(J,{to:"/logout",className:"nav-link",children:"Logout"})}):e(J,{to:"/login",className:"nav-link",children:"Login"})})})]})})},st=()=>{const r=A(S,"images"),t=async(o,n)=>{try{await H(U(S,"albums",o)),await s(n)}catch(a){console.log("error",a.message)}},s=async o=>{console.log("checking for doc children");const n=M(r,B("albumId","==",o)),a=await _(n);try{a.forEach(async({id:c})=>{await H(U(S,"images",c))})}catch(c){console.log("error",c.message)}console.log("returning to parent function")};return{deleteAlbumDoc:t}},le=()=>{const r=A(S,"images"),t=async o=>{const n=[];(await _(r)).forEach(u=>{n.push(u.data())}),n.filter(u=>u.albumId===o).forEach(u=>{const i=n.filter(d=>d.path===u.path);i.length===1&&s(i[0].path),console.log("no matches to be found")})},s=async o=>{const n=X(oe,o);try{await Fe(n),console.log("profit, image deleted with path ::>",o)}catch(a){console.log("error",a.message)}};return{deleteFromBucket:s,findRelatedDocuments:t}},K=(r={})=>{const[t,s]=h.exports.useState(null),{user:o}=k(),n=T(),{deleteAlbumDoc:a}=st(),{findRelatedDocuments:c}=le();h.exports.useEffect(()=>{if(!t)return;const w=setTimeout(()=>s(null),3e3);return()=>clearTimeout(w)},[t]);const u=A(S,"albums"),i=r.onAlbumPage?["album",r.albumId]:["albums",o.uid],d=r.onAlbumPage?M(u,B("albumId","==",r.albumId)):M(u,B("owner","==",o.uid)),l=ee(i,d,{idField:"_id",subscribe:!0},{refetchOnMount:"always"});return{createAlbum:async w=>{const f=O();try{await q(u,{albumId:f,albumName:w,created:E(),edited:E(),owner:o.uid}),n(`/albums/${f}`)}catch(v){console.log("error",v.message)}},albumQuery:l,editAlbum:async(w,f)=>{const v=U(S,"albums",f);try{await Ue(v,{albumName:w,edited:E()})}catch(I){console.log(I.message)}},deleteAlbumById:async({documentId:w,albumId:f})=>{await c(f),await a(w,f),s(`Album with id ${f} deleted`)},message:t}},ce=(r=null)=>{const t=A(S,"images"),s=["images",r],o=M(t,B("albumId","==",r));return ee(s,o,{idField:"_id",subscribe:!0},{refetchOnMount:"always"})},nt=()=>{const{deleteFromBucket:r}=le();return{deleteDocument:async(s,o)=>{const n=A(S,"images"),a=M(n,B("path","==",o)),c=await _(a);let u=[];c.forEach(i=>{u.push(i.data())}),u.length===1&&(console.log("fire deletefunction"),r(o));try{await H(U(S,"images",s)),console.log("profit")}catch(i){console.log("error",i.message)}}}},ie=({isLoading:r,isError:t,data:s,isThumbnail:o,handleClick:n})=>r?e("h1",{children:"Loding ..."}):t?e("h1",{children:`${images.error}`}):e("div",{className:"mx-auto",children:e(Te,{children:e(te,{children:s&&s.map(a=>m(re,{xs:12,sm:4,md:3,children:[e("div",{className:"img-wrapper",children:e("img",{src:a.url,alt:""})}),!o&&e(b,{variant:"danger",onClick:()=>n(a._id,a.path),children:"Delete me"})]},a._id))})})}),ot={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd",outline:"none",transition:"border .24s ease-in-out"},at={borderColor:"#2196f3"},lt={borderColor:"#00e676"},ct={borderColor:"#ff1744"},it=["warning","success","danger","info"],dt=()=>{const[r,t]=h.exports.useState(null),[s,o]=h.exports.useState(),{user:n}=k();return{upload:(c=null,u)=>{if(!c)return;const i=c.length;let d=[];for(let l=0;l<i;l++){const g=Math.floor(Math.random()*(3+1));d.push({progress:10,variant:it[g]})}o(d),c.forEach((l,g)=>{const N=O(),D=l.name.substring(l.name.lastIndexOf(".")+1),w=X(oe,`images/${N}.${D}`);Oe(w,l).on("state_changed",v=>{const I=v.bytesTransferred/v.totalBytes*100;d[g].progress=I,o([...d])},v=>{console.log(v.message),t({type:"warning",msg:`Image failed to upload due to the following error: ${v}`})},async()=>{const v=await qe(w),I=A(S,"images");await q(I,{albumId:u,name:l.name,path:w.fullPath,size:l.size,type:l.type,owner:n.uid,ext:D,url:v,uuid:N}),t({type:"success",msg:"Congrats your file/files are uploaded"})})})},message:r,progressArray:s}},ut=({albumId:r})=>{const t=dt(),s=h.exports.useCallback(d=>{t.upload(d,r)},[]),{getRootProps:o,getInputProps:n,isDragActive:a,isDragAccept:c,isDragReject:u}=$e({onDrop:s,accept:["image/*","png"]}),i=h.exports.useMemo(()=>C(C(C(C({},ot),a?at:{}),c?lt:{}),u?ct:{}),[a,u,c]);return m(y,{children:[m("div",F(C({},o({style:i})),{className:"my-3",children:[e("input",C({},n())),a?e("p",{children:"Drop the files here ..."}):e("p",{children:"Drag 'n' drop some files here, or click to select files"})]})),t.progressArray&&t.progressArray.map((d,l)=>e(je,{striped:!0,variant:d.variant,now:d.progress},l))]})},mt=(r,t)=>{const s=r,o=r.findIndex(n=>n.image.uuid===t.image.uuid);return s.splice(o,1,{image:t.image,liked:t.liked}),s},ht=(r,t)=>{const s=r!==null&&r.toDate().toLocaleString("en-GB"),o=t!==null&&t.toDate().toLocaleString("en-GB");return[s,o]},gt=({item:r,handleClick:t,isLiked:s})=>m(y,{children:[e("p",{children:s?"liked":"disliked"}),e("div",{onClick:()=>t(r),className:`selected img-wrapper ${s?"liked":"disliked"}`,children:e("img",{src:r.image.url,alt:""})})]}),pt=()=>{const[r,t]=h.exports.useState(!1),[s,o]=h.exports.useState(null);return{createAlbum:async(a,c)=>{o(null);const u=O(),i=A(S,"albums"),d=A(S,"images");try{t(!0),await q(i,{albumId:u,albumName:u,created:E(),edited:E(),owner:a}),c.forEach(l=>{const g=O();q(d,{albumId:u,name:l.image.name,path:l.image.path,size:l.image.size,type:l.image.type,owner:l.image.owner,ext:l.image.ext,url:l.image.url,uuid:g})}),t(!1),o({msg:"New Album Created",type:"success"})}catch(l){console.log(l.message),o({msg:"Something Went Wrong",type:"warning"}),t(!1)}},isLoading:r,message:s}},de=({selected:r,total:t,owner:s,editImage:o})=>{const{createAlbum:n,isLoading:a,message:c}=pt(),u=()=>{const i=r.filter(d=>d.liked===!0);n(s,i)};return m("div",{children:[c&&e($,{className:"text-center",variant:c.type,children:c.msg}),!c&&m(y,{children:[m("p",{className:"text-end",children:[t," of ",r.length," kept"," "]}),e(te,{children:r==null?void 0:r.map((i,d)=>{const l=!!i.liked;return e(re,{xs:12,sm:4,md:3,children:e(gt,{isLiked:l,item:i,handleClick:()=>o(i)})},d)})}),e(b,{className:"my-3",disabled:a,variant:"success",onClick:u,children:"Create new album from selection"})]})]})},ft=({show:r,handleClose:t,url:s})=>e(y,{children:m(x,{show:r,onHide:()=>t("url"),centered:!0,keyboard:!1,children:[e(x.Header,{closeButton:!0,children:e(x.Title,{children:"Album url"})}),e(x.Body,{children:e(p.Control,{readOnly:!0,type:"text",value:"https://cranky-elion-781b13.netlify.app"+s})}),e(x.Footer,{children:e(b,{onClick:()=>t("url"),variant:"primary",children:"Close"})})]})}),ue=({data:r,nextStep:t,handleSelectedImage:s})=>{const[o,n]=h.exports.useState(0),[a,c]=h.exports.useState(!1),u=d=>{s(d),n(l=>o+1===r.length?(c(!0),l):l+1)};return e(R,{children:r&&!a?m(y,{children:[e("h3",{className:"text-center",children:"Hot or not?"}),m("div",{className:"selecter-wrapper",children:[e("div",{className:"img-wrapper my-2",children:e("img",{src:r[o].url,alt:""})}),m("div",{className:"d-flex",children:[e(b,{onClick:()=>u({image:r[o],liked:!1}),disabled:a,className:"m-1",variant:"danger",children:"\u{1F9CA}"}),e(b,{variant:"success",onClick:()=>u({image:r[o],liked:!0}),disabled:a,className:"m-1",children:"\u{1F525}"})]})]})]}):e("div",{className:"selecter-wrapper",children:e(b,{onClick:()=>t(3),children:"Go to selection"})})})},me=()=>{const[r,t]=h.exports.useState(1),[s,o]=h.exports.useState(0),[n,a]=h.exports.useState(null);h.exports.useMemo(()=>{if(n){const l=n.filter(g=>g.liked===!0).length;o(l)}},[n]);const c=l=>{a(g=>g?[...g,{image:l.image,liked:l.liked}]:[l])},u=l=>{const g={image:l.image,liked:!l.liked,edited:!0},N=mt(n,g);a([...N])},i=l=>{t(l)};return{step:r,nextStep:i,total:s,selected:n,handleSelectedImage:c,editImage:u,resetSelection:()=>{i(1),a(null)}}},Q=({show:r,handleClose:t,handleSubmit:s,setInput:o,input:n,isConfirm:a,deleteAlbum:c})=>e(y,{children:m(x,{show:r,onHide:t,centered:!0,keyboard:!1,children:[a&&m(y,{children:[e(x.Header,{closeButton:!0,children:"Deleting"}),e(x.Body,{children:"Are you sure you want to delete this album?"}),e(x.Footer,{children:e(b,{onClick:c,variant:"danger",children:"Confirm"})})]}),!a&&m(y,{children:[e(x.Header,{closeButton:!0,children:e(x.Title,{children:"Name your album"})}),m(p,{onSubmit:s,children:[e(x.Body,{children:e(p.Control,{value:n,onChange:u=>o(u.target.value),required:!0,type:"text",placeholder:"Enter Album Name"})}),e(x.Footer,{children:e(b,{type:"submit",variant:"primary",children:"Continue"})})]})]})]})}),bt=()=>{const[r,t]=h.exports.useState(!1),[s,o]=h.exports.useState(!1),[n,a]=h.exports.useState(""),{pathname:c}=Ge(),{albumId:u}=se(),{step:i,nextStep:d,total:l,selected:g,resetSelection:N,handleSelectedImage:D,editImage:w}=me(),{albumQuery:f,editAlbum:v}=K({onAlbumPage:!0,albumId:u}),I=ce(u),{deleteDocument:pe}=nt(),G=L=>{L?o(!1):t(!1)},V=L=>{L?o(!0):t(!0)},fe=(L,ve)=>pe(L,ve),be=()=>d(2),ye=L=>{L.preventDefault(),v(n.trim(),f==null?void 0:f.data[0]._id),G()},we=()=>{a(f.data[0].albumName),V()};return f.isLoading?e("h1",{children:"Loding ..."}):f.isError?e("h1",{children:`${f.error}`}):m(R,{children:[m("div",{className:"my-3 d-md-flex justify-content-between align-items-center",children:[m("div",{children:[m("p",{children:["Album name: ",f.data[0].albumName,e("span",{onClick:we,className:"mx-3 edit-span",children:"Change my name?"})]}),e(Q,{handleSubmit:ye,show:r,handleClose:G,input:n,setInput:a}),I.data&&m(y,{children:[m("p",{children:["Total amount:",e("span",{style:{fontWeight:"bolder"},children:I.data.length})]}),m("div",{className:"album-handler",children:[e(b,{className:"album-handler-button",onClick:()=>V("url"),children:"Generate url"}),e(b,{disabled:I.data.length===0,onClick:i===1?be:N,variant:i!==1?"danger":"success",className:"album-handler-button",children:i!==1?"Reset Selection":"Select Images"})]})]})]}),e(ft,{show:s,handleClose:G,url:c})]}),i===1&&m(y,{children:[e(ut,{albumId:u})," ",e(ie,C({handleClick:fe},I))]}),i===2&&e(ue,F(C({selected:g},I),{nextStep:d,handleSelectedImage:D})),i===3&&e(de,{owner:f.data[0].owner,total:l,selected:g,editImage:w})]})},he=()=>{const[r,t]=h.exports.useState(!1);return[()=>t(!0),()=>t(!1),r]},yt=({albums:r,deleteAlbumById:t})=>{const[s,o,n]=he(),[a,c]=h.exports.useState(),u=(d,l)=>{c({documentId:d,albumId:l}),s()},i=()=>{t(a),o()};return m(We,{responsive:!0,striped:!0,bordered:!0,hover:!0,children:[e("thead",{children:m("tr",{children:[e("th",{children:"#"}),e("th",{children:"Name"}),e("th",{children:"Created"}),e("th",{children:"Updated"})]})}),e("tbody",{children:r.map((d,l)=>{const[g,N]=ht(d.created,d.edited);return m("tr",{children:[e("td",{children:l+1}),e("td",{children:e(z,{to:`/albums/${d.albumId}`,children:d.albumName})}),e("td",{children:g}),e("td",{children:N}),e("td",{className:"d-flex justify-content-center",children:e(b,{onClick:()=>u(d._id,d.albumId),variant:"danger",children:"Delete Me"})})]},l)})}),e(Q,{deleteAlbum:i,show:n,handleClose:o,isConfirm:!0})]})},wt=()=>{const[r,t]=h.exports.useState(""),[s,o,n]=he(),{user:a}=k(),{deleteAlbumById:c,createAlbum:u,albumQuery:i,message:d}=K(),l=g=>{g.preventDefault(),u(r.trim())};return i.isLoading?e("h3",{children:"Loading ..."}):i.isError?e("h3",{children:"Something went wrong"}):m(y,{children:[m(R,{children:[m("h1",{className:"my-3",children:["Welcome ",e("span",{children:a==null?void 0:a.email})]}),e(b,{onClick:s,variant:"success",children:"Create New Album"}),d&&e($,{variant:"success",className:"my-3 text-center",children:d}),i.data&&i.data.length>0?m("div",{children:[e("h3",{className:"my-3",children:"Your Albums"}),e(yt,{deleteAlbumById:c,albums:i==null?void 0:i.data})]}):e("h3",{className:"my-3",children:"No albums here yet ..."})]}),e(Q,{handleSubmit:l,show:n,handleClose:o,input:r,setInput:t})]})},vt=()=>{const[r,t]=h.exports.useState(!1),[s,o]=h.exports.useState(null),n=T(),{login:a}=k();return{signIn:async(u,i)=>{try{t(!0),await a(u,i),n("/")}catch(d){o(d.message),t(!1)}},isLoading:r,errorMessage:s}},xt=()=>{const r=h.exports.useRef(),t=h.exports.useRef(),{signIn:s,isLoading:o,errorMessage:n}=vt();return m(R,{children:[e("h3",{className:"py-3",children:"Sign in to start using Photo Reviewer"}),n&&e($,{variant:"warning",children:n}),m(p,{onSubmit:c=>{c.preventDefault(),s(r.current.value,t.current.value)},children:[m(p.Group,{className:"mb-3",controlId:"formBasicEmail",children:[e(p.Label,{children:"Email address"}),e(p.Control,{required:!0,ref:r,type:"email",placeholder:"Enter email"})]}),m(p.Group,{className:"mb-3",controlId:"formBasicPassword",children:[e(p.Label,{children:"Password"}),e(p.Control,{required:!0,ref:t,type:"password",placeholder:"Password"})]}),m("div",{className:"d-md-flex flex-row-reverse justify-content-between",children:[e("p",{children:e(z,{to:"/signup",children:"Register?"})}),e(b,{disabled:o,variant:"primary",type:"submit",children:"Login"})]})]})]})},St=()=>{const{logout:r}=k(),t=T();return h.exports.useEffect(async()=>{await r(),t("/login")},[]),e("h1",{children:"Logging you out!"})},It=()=>e("h1",{children:"Sorry the page could not be found"}),Ct=()=>{const{albumId:r}=se(),{step:t,nextStep:s,total:o,selected:n,handleSelectedImage:a,editImage:c}=me(),{albumQuery:u}=K({isSingleAlbum:!0,albumId:r}),i=ce(r),d=()=>s(2);return u.isLoading?e("h1",{children:"Loding ..."}):u.isError?e("h1",{children:`${album.error}`}):m(R,{children:[t===1&&m(y,{children:[m("div",{className:"d-md-flex justify-content-between align-items-center",children:[e("h1",{children:"Welcome to preview page."}),e(b,{onClick:d,variant:"success",children:"Select photos"})]}),e(ie,C({isThumbnail:!0},i))]}),t===2&&e(ue,F(C({selected:n},i),{nextStep:s,handleSelectedImage:a})),t===3&&e(de,{owner:u.data[0].owner,total:o,selected:n,editImage:c})]})},Nt=()=>{const[r,t]=h.exports.useState(!1),[s,o]=h.exports.useState(null),n=T(),{register:a,user:c}=k();return console.log(c==null?void 0:c.uid),{isLoading:r,errorMessage:s,createUser:async(i,d,l)=>{if(d!==l){o("Passwords does not match");return}try{t(!0),await a(i,d),n("/")}catch(g){o(g.message),t(!1)}},setErrorMessage:o}},At=()=>{const[r,t]=h.exports.useState(!1),s=h.exports.useRef(),o=h.exports.useRef(),n=h.exports.useRef(),a=Nt(),c=async u=>{u.preventDefault(),await a.createUser(s.current.value,o.current.value,n.current.value)};return m(R,{children:[e("h3",{className:"py-3",children:"Register to start using Photo Reviewer"}),a.errorMessage&&e($,{variant:"warning",children:a.errorMessage}),m(p,{onSubmit:c,children:[m(p.Group,{className:"mb-3",controlId:"formBasicEmail",children:[e(p.Label,{children:"Email address"}),e(p.Control,{ref:s,type:"email",placeholder:"Enter email"})]}),m(p.Group,{className:"mb-3",controlId:"formBasicPassword",children:[e(p.Label,{children:"Password"}),e(p.Control,{ref:o,type:r?"text":"password",placeholder:"Password"})]}),m(p.Group,{className:"mb-3",controlId:"formBasicPassword",children:[e(p.Label,{children:"Confirm Password"}),e(p.Control,{ref:n,type:r?"text":"password",placeholder:"Confirm Password"})]}),e(p.Group,{className:"mb-3",controlId:"formBasicCheckbox",children:e(p.Check,{onChange:()=>t(!r),type:"checkbox",label:"Show password"})}),e(b,{disabled:a.isLoading,variant:"primary",type:"submit",children:"Submit"})]})]})};function ge({children:r,redirectTo:t}){const{user:s}=k();return s?r:e(ze,{to:t})}function kt(){return m(y,{children:[e(rt,{}),m(He,{children:[e(P,{path:"/",element:e(ge,{redirectTo:"/login",children:e(wt,{})})}),e(P,{path:"/login",element:e(xt,{})}),e(P,{path:"/signup",element:e(At,{})}),e(P,{path:"/logout",element:e(St,{})}),e(P,{path:"/albums/:albumId",element:e(ge,{redirectTo:"/login",children:e(bt,{})})}),e(P,{path:"/preview/:albumId",element:e(Ct,{})}),e(P,{path:"*",element:e(It,{})})]})]})}const Lt=new _e({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:1e3*60*2,cacheTime:1e3*60*60*4}}});Ke.render(e(Qe.StrictMode,{children:e(Ve,{children:m(Ye,{client:Lt,children:[e(tt,{children:e(Ze,{children:e(kt,{})})}),e(Je.exports.ReactQueryDevtools,{initialIsOpen:!1})]})})}),document.getElementById("root"));
