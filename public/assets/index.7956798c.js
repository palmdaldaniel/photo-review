var we=Object.defineProperty,ve=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var Y=(t,r,s)=>r in t?we(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,C=(t,r)=>{for(var s in r||(r={}))Se.call(r,s)&&Y(t,s,r[s]);if(V)for(var s of V(r))Ie.call(r,s)&&Y(t,s,r[s]);return t},E=(t,r)=>ve(t,xe(r));import{i as Ce,g as Ne,L as Ae,a as ke,r as h,o as Le,j as u,b as e,c as Re,s as Pe,d as De,N as G,C as R,e as W,f as Me,F as y,h as Z,V as k,p as z,D as F,U as D,K as M,w as H,k as J,l as Be,u as T,m as X,v as U,T as O,n as B,y as Ee,I as Fe,R as ee,q as te,B as b,t as Te,x as Ue,z as Oe,P as qe,A as q,M as S,E as g,G as $e,H as re,J as je,O as Ge,Q as We,S as P,W as ze,X as He,Y as _e,Z as Ke,_ as Qe,$ as Ve,a0 as Ye}from"./vendor.c20dfaf5.js";const Ze=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}};Ze();const Je={apiKey:"AIzaSyBvo498Ndy4hxto3yV4hIAsmlZx85gdRhs",authDomain:"photo-review-aad07.firebaseapp.com",projectId:"photo-review-aad07",storageBucket:"photo-review-aad07.appspot.com",messagingSenderId:"570970856677",appId:"1:570970856677:web:abd2e7c16a5f9db671080c"},se=Ce(Je),$=Ne(),I=Ae(se),ne=ke(se),ae=h.exports.createContext(),L=()=>h.exports.useContext(ae),Xe=({children:t})=>{const[r,s]=h.exports.useState(null),[n,a]=h.exports.useState(!0);h.exports.useEffect(()=>{Le($,i=>{s(i),a(!1)})},[]);const m={user:r,register:(i,c)=>Re($,i,c),login:(i,c)=>Pe($,i,c),logout:()=>De($)};return u(ae.Provider,{value:m,children:[n&&e("h1",{children:"Loading ..."}),!n&&t]})},et=()=>{const{user:t}=L();return e(G,{bg:"dark",variant:"dark",expand:"md",children:u(R,{children:[e(W,{to:"/",className:"navbar-brand",children:"Photo Reviewer"}),e(G.Toggle,{"aria-controls":"basic-navbar-nav"}),e(G.Collapse,{id:"basic-navbar-nav",children:e(Me,{className:"ms-auto",children:t?e(y,{children:e(Z,{to:"/logout",className:"nav-link",children:"Logout"})}):e(Z,{to:"/login",className:"nav-link",children:"Login"})})})]})})},tt=()=>{const t=k(I,"images"),r=async(n,a)=>{try{await z(F(I,"albums",n)),await s(a)}catch(o){console.log("error",o.message)}},s=async n=>{console.log("checking for doc children");const a=D(t,M("albumId","==",n)),o=await H(a);try{o.forEach(async({id:l})=>{await z(F(I,"images",l))})}catch(l){console.log("error",l.message)}console.log("returning to parent function")};return{deleteAlbumDoc:r}},oe=()=>{const t=k(I,"images"),r=async n=>{const a=[];(await H(t)).forEach(d=>{a.push(d.data())}),a.filter(d=>d.albumId===n).forEach(d=>{const m=a.filter(i=>i.path===d.path);m.length===1&&s(m[0].path),console.log("no matches to be found")})},s=async n=>{const a=J(ne,n);try{await Be(a),console.log("profit, image deleted with path ::>",n)}catch(o){console.log("error",o.message)}};return{deleteFromBucket:s,findRelatedDocuments:r}},_=(t={})=>{const[r,s]=h.exports.useState(null),{user:n}=L(),a=T(),{deleteAlbumDoc:o}=tt(),{findRelatedDocuments:l}=oe();h.exports.useEffect(()=>{if(!r)return;const v=setTimeout(()=>s(null),3e3);return()=>clearTimeout(v)},[r]);const d=k(I,"albums"),m=t.onAlbumPage?["album",t.albumId]:["albums",n.uid],i=t.onAlbumPage?D(d,M("albumId","==",t.albumId)):D(d,M("owner","==",n.uid)),c=X(m,i,{idField:"_id",subscribe:!0},{refetchOnMount:"always"});return{createAlbum:async v=>{const f=U();try{await O(d,{albumId:f,albumName:v,created:B(),edited:B(),owner:n.uid}),a(`/albums/${f}`)}catch(x){console.log("error",x.message)}},albumQuery:c,editAlbum:async(v,f)=>{const x=F(I,"albums",f);try{await Ee(x,{albumName:v,edited:B()})}catch(A){console.log(A.message)}},deleteAlbumById:async({documentId:v,albumId:f})=>{await l(f),await o(v,f),s(`Album with id ${f} deleted`)},message:r}},le=(t=null)=>{const r=k(I,"images"),s=["images",t],n=D(r,M("albumId","==",t));return X(s,n,{idField:"_id",subscribe:!0},{refetchOnMount:"always"})},rt=()=>{const{deleteFromBucket:t}=oe();return{deleteDocument:async(s,n)=>{const a=k(I,"images"),o=D(a,M("path","==",n)),l=await H(o);let d=[];l.forEach(m=>{d.push(m.data())}),d.length===1&&(console.log("fire deletefunction"),t(n));try{await z(F(I,"images",s)),console.log("profit")}catch(m){console.log("error",m.message)}}}},ce=({isLoading:t,isError:r,data:s,isThumbnail:n,handleClick:a})=>t?e("h1",{children:"Loding ..."}):r?e("h1",{children:`${images.error}`}):e("div",{className:"mx-auto",children:e(Fe,{children:e(ee,{children:s&&s.map(o=>u(te,{xs:12,sm:4,md:3,children:[e("div",{className:"img-wrapper",children:e("img",{src:o.url,alt:""})}),!n&&e(b,{variant:"danger",onClick:()=>a(o._id,o.path),children:"Delete me"})]},o._id))})})}),st={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd",outline:"none",transition:"border .24s ease-in-out"},nt={borderColor:"#2196f3"},at={borderColor:"#00e676"},ot={borderColor:"#ff1744"},lt=["warning","success","danger","info"],ct=()=>{const[t,r]=h.exports.useState(null),[s,n]=h.exports.useState(),{user:a}=L();return{upload:(l=null,d)=>{if(!l)return;const m=l.length;let i=[];for(let c=0;c<m;c++){const p=Math.floor(Math.random()*(3+1));i.push({progress:10,variant:lt[p]})}n(i),l.forEach((c,p)=>{const N=U(),w=c.name.substring(c.name.lastIndexOf(".")+1),v=J(ne,`images/${N}.${w}`);Te(v,c).on("state_changed",x=>{const A=x.bytesTransferred/x.totalBytes*100;i[p].progress=A,n([...i])},x=>{console.log(x.message),r({type:"warning",msg:`Image failed to upload due to the following error: ${x}`})},async()=>{const x=await Ue(v),A=k(I,"images");await O(A,{albumId:d,name:c.name,path:v.fullPath,size:c.size,type:c.type,owner:a.uid,ext:w,url:x,uuid:N}),r({type:"success",msg:"Congrats your file/files are uploaded"})})})},message:t,progressArray:s}},it=({albumId:t})=>{const r=ct(),s=h.exports.useCallback(i=>{r.upload(i,t)},[]),{getRootProps:n,getInputProps:a,isDragActive:o,isDragAccept:l,isDragReject:d}=Oe({onDrop:s,accept:["image/*","png"]}),m=h.exports.useMemo(()=>C(C(C(C({},st),o?nt:{}),l?at:{}),d?ot:{}),[o,d,l]);return u(y,{children:[u("div",E(C({},n({style:m})),{className:"my-3",children:[e("input",C({},a())),o?e("p",{children:"Drop the files here ..."}):e("p",{children:"Drag 'n' drop some files here, or click to select files"})]})),r.progressArray&&r.progressArray.map((i,c)=>e(qe,{striped:!0,variant:i.variant,now:i.progress},c))]})},dt=(t,r)=>{const s=t,n=t.findIndex(a=>a.image.uuid===r.image.uuid);return s.splice(n,1,{image:r.image,liked:r.liked}),s},ut=(t,r)=>{const s=t!==null&&t.toDate().toLocaleString("en-GB"),n=r!==null&&r.toDate().toLocaleString("en-GB");return[s,n]},mt=({item:t,handleClick:r,isLiked:s})=>u(y,{children:[e("p",{children:s?"liked":"disliked"}),e("div",{onClick:()=>r(t),className:`selected img-wrapper ${s?"liked":"disliked"}`,children:e("img",{src:t.image.url,alt:""})})]}),ht=()=>{const[t,r]=h.exports.useState(!1),[s,n]=h.exports.useState(null);return{createAlbum:async(o,l)=>{n(null);const d=U(),m=k(I,"albums"),i=k(I,"images");try{r(!0),await O(m,{albumId:d,albumName:d,created:B(),edited:B(),owner:o}),l.forEach(c=>{const p=U();O(i,{albumId:d,name:c.image.name,path:c.image.path,size:c.image.size,type:c.image.type,owner:c.image.owner,ext:c.image.ext,url:c.image.url,uuid:p})}),r(!1),n({msg:"New Album Created",type:"success"})}catch(c){console.log(c.message),n({msg:"Something Went Wrong",type:"warning"}),r(!1)}},isLoading:t,message:s}},ie=({selected:t,total:r,owner:s,editImage:n})=>{const{createAlbum:a,isLoading:o,message:l}=ht(),d=()=>{const m=t.filter(i=>i.liked===!0);a(s,m)};return u("div",{children:[l&&e(q,{className:"text-center",variant:l.type,children:l.msg}),!l&&u(y,{children:[u("p",{className:"text-end",children:[r," of ",t.length," kept"," "]}),e(ee,{children:t==null?void 0:t.map((m,i)=>{const c=!!m.liked;return e(te,{xs:12,sm:4,md:3,children:e(mt,{isLiked:c,item:m,handleClick:()=>n(m)})},i)})}),e(b,{className:"my-3",disabled:o,variant:"success",onClick:d,children:"Create new album from selection"})]})]})},gt=({show:t,handleClose:r,url:s})=>e(y,{children:u(S,{show:t,onHide:r,centered:!0,keyboard:!1,children:[e(S.Header,{closeButton:!0,children:e(S.Title,{children:"Album url"})}),e(S.Body,{children:e(g.Control,{readOnly:!0,type:"text",value:"netlifyname"+s})}),e(S.Footer,{children:e(b,{onClick:r,variant:"primary",children:"Close"})})]})}),de=({data:t,nextStep:r,handleSelectedImage:s})=>{const[n,a]=h.exports.useState(0),[o,l]=h.exports.useState(!1),d=i=>{s(i),a(c=>n+1===t.length?(l(!0),c):c+1)};return e(R,{children:t&&!o?u(y,{children:[e("h3",{className:"text-center",children:"Hot or not?"}),u("div",{className:"selecter-wrapper",children:[e("div",{className:"img-wrapper my-2",children:e("img",{src:t[n].url,alt:""})}),u("div",{className:"d-flex",children:[e(b,{onClick:()=>d({image:t[n],liked:!1}),disabled:o,className:"m-1",variant:"danger",children:"\u{1F9CA}"}),e(b,{variant:"success",onClick:()=>d({image:t[n],liked:!0}),disabled:o,className:"m-1",children:"\u{1F525}"})]})]})]}):e("div",{className:"selecter-wrapper",children:e(b,{onClick:()=>r(3),children:"Go to selection"})})})},ue=()=>{const[t,r]=h.exports.useState(1),[s,n]=h.exports.useState(0),[a,o]=h.exports.useState(null);h.exports.useMemo(()=>{if(a){const c=a.filter(p=>p.liked===!0).length;n(c)}},[a]);const l=c=>{o(p=>p?[...p,{image:c.image,liked:c.liked}]:[c])},d=c=>{const p={image:c.image,liked:!c.liked,edited:!0},N=dt(a,p);o([...N])},m=c=>{r(c)};return{step:t,nextStep:m,total:s,selected:a,handleSelectedImage:l,editImage:d,resetSelection:()=>{m(1),o(null)}}},K=({show:t,handleClose:r,handleSubmit:s,setInput:n,input:a,isConfirm:o,deleteAlbum:l})=>e(y,{children:u(S,{show:t,onHide:r,centered:!0,keyboard:!1,children:[o&&u(y,{children:[e(S.Header,{closeButton:!0,children:"Deleting"}),e(S.Body,{children:"Are you sure you want to delete this album?"}),e(S.Footer,{children:e(b,{onClick:l,variant:"danger",children:"Confirm"})})]}),!o&&u(y,{children:[e(S.Header,{closeButton:!0,children:e(S.Title,{children:"Name your album"})}),u(g,{onSubmit:s,children:[e(S.Body,{children:e(g.Control,{value:a,onChange:d=>n(d.target.value),required:!0,type:"text",placeholder:"Enter Album Name"})}),e(S.Footer,{children:e(b,{type:"submit",variant:"primary",children:"Continue"})})]})]})]})}),pt=()=>{const[t,r]=h.exports.useState(!1),[s,n]=h.exports.useState(""),{pathname:a}=$e(),{albumId:o}=re(),{step:l,nextStep:d,total:m,selected:i,resetSelection:c,handleSelectedImage:p,editImage:N}=ue(),{albumQuery:w,editAlbum:v}=_({onAlbumPage:!0,albumId:o}),f=le(o),{deleteDocument:x}=rt(),A=()=>r(!1),Q=()=>r(!0),ge=(j,ye)=>x(j,ye),pe=()=>d(2),fe=j=>{j.preventDefault(),v(s.trim(),w==null?void 0:w.data[0]._id),A()},be=()=>{n(w.data[0].albumName),Q()};return w.isLoading?e("h1",{children:"Loding ..."}):w.isError?e("h1",{children:`${w.error}`}):u(R,{children:[u("div",{className:"my-3 d-md-flex justify-content-between align-items-center",children:[u("div",{children:[u("p",{children:["Album name: ",w.data[0].albumName,e("span",{onClick:be,className:"mx-3 edit-span",children:"Change my name?"})]}),e(K,{handleSubmit:fe,show:t,handleClose:A,input:s,setInput:n}),f.data&&u(y,{children:[u("p",{children:["Total amount:",e("span",{style:{fontWeight:"bolder"},children:f.data.length})]}),u("div",{className:"album-handler",children:[e(b,{className:"album-handler-button",onClick:Q,children:"Generate url"}),e(b,{disabled:f.data.length===0,onClick:l===1?pe:c,variant:l!==1?"danger":"success",className:"album-handler-button",children:l!==1?"Reset Selection":"Select Images"})]})]})]}),e(gt,{show:t,handleClose:A,url:a})]}),l===1&&u(y,{children:[e(it,{albumId:o})," ",e(ce,C({handleClick:ge},f))]}),l===2&&e(de,E(C({selected:i},f),{nextStep:d,handleSelectedImage:p})),l===3&&e(ie,{owner:w.data[0].owner,total:m,selected:i,editImage:N})]})},me=()=>{const[t,r]=h.exports.useState(!1);return[()=>r(!0),()=>r(!1),t]},ft=({albums:t,deleteAlbumById:r})=>{const[s,n,a]=me(),[o,l]=h.exports.useState(),d=(i,c)=>{l({documentId:i,albumId:c}),s()},m=()=>{r(o),n()};return u(je,{responsive:!0,striped:!0,bordered:!0,hover:!0,children:[e("thead",{children:u("tr",{children:[e("th",{children:"#"}),e("th",{children:"Name"}),e("th",{children:"Created"}),e("th",{children:"Updated"})]})}),e("tbody",{children:t.map((i,c)=>{const[p,N]=ut(i.created,i.edited);return u("tr",{children:[e("td",{children:c+1}),e("td",{children:e(W,{to:`/albums/${i.albumId}`,children:i.albumName})}),e("td",{children:p}),e("td",{children:N}),e("td",{className:"d-flex justify-content-center",children:e(b,{onClick:()=>d(i._id,i.albumId),variant:"danger",children:"Delete Me"})})]},c)})}),e(K,{deleteAlbum:m,show:a,handleClose:n,isConfirm:!0})]})},bt=()=>{const[t,r]=h.exports.useState(""),[s,n,a]=me(),{user:o}=L(),{deleteAlbumById:l,createAlbum:d,albumQuery:m,message:i}=_(),c=p=>{p.preventDefault(),d(t.trim())};return m.isLoading?e("h3",{children:"Loading ..."}):m.isError?e("h3",{children:"Something went wrong"}):u(y,{children:[u(R,{children:[u("h1",{className:"my-3",children:["Welcome ",e("span",{children:o==null?void 0:o.email})]}),e(b,{onClick:s,variant:"success",children:"Create New Album"}),i&&e(q,{variant:"success",className:"my-3 text-center",children:i}),m.data&&m.data.length>0?u("div",{children:[e("h3",{className:"my-3",children:"Your Albums"}),e(ft,{deleteAlbumById:l,albums:m==null?void 0:m.data})]}):e("h3",{className:"my-3",children:"No albums here yet ..."})]}),e(K,{handleSubmit:c,show:a,handleClose:n,input:t,setInput:r})]})},yt=()=>{const[t,r]=h.exports.useState(!1),[s,n]=h.exports.useState(null),a=T(),{login:o}=L();return{signIn:async(d,m)=>{try{r(!0),await o(d,m),a("/")}catch(i){n(i.message),r(!1)}},isLoading:t,errorMessage:s}},wt=()=>{const t=h.exports.useRef(),r=h.exports.useRef(),{signIn:s,isLoading:n,errorMessage:a}=yt();return u(R,{children:[e("h3",{className:"py-3",children:"Sign in to start using Photo Reviewer"}),a&&e(q,{variant:"warning",children:a}),u(g,{onSubmit:l=>{l.preventDefault(),s(t.current.value,r.current.value)},children:[u(g.Group,{className:"mb-3",controlId:"formBasicEmail",children:[e(g.Label,{children:"Email address"}),e(g.Control,{required:!0,ref:t,type:"email",placeholder:"Enter email"})]}),u(g.Group,{className:"mb-3",controlId:"formBasicPassword",children:[e(g.Label,{children:"Password"}),e(g.Control,{required:!0,ref:r,type:"password",placeholder:"Password"})]}),u("div",{className:"d-md-flex flex-row-reverse justify-content-between",children:[e("p",{children:e(W,{to:"/signup",children:"Register?"})}),e(b,{disabled:n,variant:"primary",type:"submit",children:"Login"})]})]})]})},vt=()=>{const{logout:t}=L(),r=T();return h.exports.useEffect(async()=>{await t(),r("/login")},[]),e("h1",{children:"Logging you out!"})},xt=()=>e("h1",{children:"Sorry the page could not be found"}),St=()=>{const{albumId:t}=re(),{step:r,nextStep:s,total:n,selected:a,handleSelectedImage:o,editImage:l}=ue(),{albumQuery:d}=_({isSingleAlbum:!0,albumId:t}),m=le(t),i=()=>s(2);return d.isLoading?e("h1",{children:"Loding ..."}):d.isError?e("h1",{children:`${album.error}`}):u(R,{children:[r===1&&u(y,{children:[u("div",{className:"d-md-flex justify-content-between align-items-center",children:[e("h1",{children:"Welcome to preview page."}),e(b,{onClick:i,variant:"success",children:"Select photos"})]}),e(ce,C({isThumbnail:!0},m))]}),r===2&&e(de,E(C({selected:a},m),{nextStep:s,handleSelectedImage:o})),r===3&&e(ie,{owner:d.data[0].owner,total:n,selected:a,editImage:l})]})},It=()=>{const[t,r]=h.exports.useState(!1),[s,n]=h.exports.useState(null),a=T(),{register:o,user:l}=L();return console.log(l==null?void 0:l.uid),{isLoading:t,errorMessage:s,createUser:async(m,i,c)=>{if(i!==c){n("Passwords does not match");return}try{r(!0),await o(m,i),a("/")}catch(p){n(p.message),r(!1)}},setErrorMessage:n}},Ct=()=>{const[t,r]=h.exports.useState(!1),s=h.exports.useRef(),n=h.exports.useRef(),a=h.exports.useRef(),o=It(),l=async d=>{d.preventDefault(),await o.createUser(s.current.value,n.current.value,a.current.value)};return u(R,{children:[e("h3",{className:"py-3",children:"Register to start using Photo Reviewer"}),o.errorMessage&&e(q,{variant:"warning",children:o.errorMessage}),u(g,{onSubmit:l,children:[u(g.Group,{className:"mb-3",controlId:"formBasicEmail",children:[e(g.Label,{children:"Email address"}),e(g.Control,{ref:s,type:"email",placeholder:"Enter email"})]}),u(g.Group,{className:"mb-3",controlId:"formBasicPassword",children:[e(g.Label,{children:"Password"}),e(g.Control,{ref:n,type:t?"text":"password",placeholder:"Password"})]}),u(g.Group,{className:"mb-3",controlId:"formBasicPassword",children:[e(g.Label,{children:"Confirm Password"}),e(g.Control,{ref:a,type:t?"text":"password",placeholder:"Confirm Password"})]}),e(g.Group,{className:"mb-3",controlId:"formBasicCheckbox",children:e(g.Check,{onChange:()=>r(!t),type:"checkbox",label:"Show password"})}),e(b,{disabled:o.isLoading,variant:"primary",type:"submit",children:"Submit"})]})]})};function he({children:t,redirectTo:r}){const{user:s}=L();return s?t:e(Ge,{to:r})}function Nt(){return u(y,{children:[e(et,{}),u(We,{children:[e(P,{path:"/",element:e(he,{redirectTo:"/login",children:e(bt,{})})}),e(P,{path:"/login",element:e(wt,{})}),e(P,{path:"/signup",element:e(Ct,{})}),e(P,{path:"/logout",element:e(vt,{})}),e(P,{path:"/albums/:albumId",element:e(he,{redirectTo:"/login",children:e(pt,{})})}),e(P,{path:"/preview/:albumId",element:e(St,{})}),e(P,{path:"*",element:e(xt,{})})]})]})}const At=new ze({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:1e3*60*2,cacheTime:1e3*60*60*4}}});He.render(e(_e.StrictMode,{children:e(Ke,{children:u(Qe,{client:At,children:[e(Xe,{children:e(Ve,{children:e(Nt,{})})}),e(Ye.exports.ReactQueryDevtools,{initialIsOpen:!1})]})})}),document.getElementById("root"));
